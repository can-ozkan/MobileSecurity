Android SDK Tools
-----------------
adb
monitor -> see running processes
aapt -> used by apktool to package source code into binary form when building apps

Emulator Restrictions
---------------------
Have root access
Cannot make phone calls
Cannot simulate calls and SMS

Android OS Basics
-----------------
Modified Linux kernel
Dalvik Virtual Machine
Each app runs under a different UID unless a developer chooses to set several apps with the same signature share a UID
/data/data is the home directory for applications/users
APK file is a zipped archived. It contains code, metadata resources etc

APK Packaging Process
----------------------
aapt converts XML resource to binary form
aidl converts .aidl to .java
All source code and output from aapt and aidl compiled into .class files by Java compiler
dx converts .class files to a single classes.dex file
apkbuilder combines all compiled resources, images and DEX file into an APK file
jarsigner signs the APK

Structure of an APK
-------------------
/assets -> Files that developers want to include
/res -> Layout, images etc in raw subdirectory
/lib -> Libraries x86, ARM, MIPS
/META-INF -> Certificate of an application, file inventory with hashes
AndroidManifest.xml -> Summary of the application, config details of the app, permissions that the app ask for etc
classes.dex -> Executable file that contains Dalvik bytecode
resources.rsrc -> Strings of the app, other resources

Drozer
------
Security assessment tool/framework that finds vulnerabilities and develops exploits
Agent, console based tool
Agent is installed on mobile device

Application Components
-----------------------
Activities -> Visual screens of an application
Services -> Components with no GUI
Broadcast Receivers -> can detect events like incoming SMS
Content Providers -> data storehouse

Code Signing
------------
Public Key Cryptography
Private key is held only by app developers
Generate key with keytool
Sign app with jarsigner
Signature in META-INF directory
Android does not verify the certificate in any way
Certificates do not need to come from a trusted CA
Most are self-signed
Certificate is checked only when app is being installed

Signing Vulnerabilities
------------------------
Master Key Vulnerabilitiy
If two files are in the APK archive with the same file name. Only the first file's hash is checked. But the second is actually deployed to the device
Potential RCE

Understanding Permissions
--------------------------
Permissions that the app ask for will be declared in AndroidManifest.xml

Application Sandboxing
----------------------
Each app runs as its own user unless it requests to run as sharedUserId and has the same signature as another application


